#!/bin/bash

# Check the testable directory is passed
if [ $# -ne 1 ]
then
	echo "Usage: $0 <directory>"
	exit
fi

# The directory the project is in
projectpath=$(realpath $1)

# The directory the script is in
zeus_dir=$(dirname $(realpath $0))

# Move to the script's directory
cd $zeus_dir

util/bin/print_title "42Zeus"

if [ ! -d $1 ]
then
	echo "Directory $projectpath does not exist, stopping..."
	exit
fi

echo "Running 42Zeus on directory $projectpath"

# Copy the testable directory into Zeus's local files
rm -rf repo/
cp -RT $projectpath repo/

project=$(util/detect_project)

if [ $project != none ]
then
	echo "Detected project $project"
	$project/tester | util/indent
else
	echo "Couldn't automatically detect project, stopping..."
fi